name: test

types: [ ]

interfaces:
  - name: FloatPipe
    hubs:
      - name: pipe
        input:
          - name: value
            value: float
        output:
          - name: result
            value: float
        type: pipe
        direction: in

blueprints:
  - name: SquareRoot
    interface: $FloatPipe
    implementation:
      javascript:
        - hubs:
            - name: pipe
              script: Math.sqrt

  - name: UseSquareRoot1
    interface: $FloatPipe
    implementation:
      javascript:
        - hubs:
            - name: pipe
              script: |
                (function (val) {
                  return (new SquareRoot()).getHub('pipe').invoke(val) + 1;
                })

  - name: UseSquareRoot2
    interface:
      hubs:
        - name: sqrt
          input:
            - value: float
          output:
            - value: float
            - value: float
          type: pipe
          direction: in
    implementation:
      javascript:
        - events:
            - name: create
              script: |
                (function () {
                  this['squareRoot'] = new SquareRoot();
                })
          hubs:
            - name: sqrt
              script: |
                (function (val) {
                  return [this['squareRoot'].getHub('pipe').invoke(val), Math.sqrt(val)];
                })
